<h1>Telegram-ассистент для предоставления расписания СЗГМУ имени И.И.Мечникова</h1>
<h2>Работу выполнили</h2>
<ul>
    <li>Багрова Анастасия, группа 5130904/30102;</li>
    <li>Мальцев Александр, группа 5130904/30102;</li>
    <li>Романчук Кирилл, группа 5130904/30102.</li>
</ul>

<h2>Проблема</h2>
<p>Студенты и преподаватели СЗГМУ им. И.И. Мечникова испытывают затруднения при поиске и интерпретации своего расписания, поскольку на официальном сайте ВУЗа оно представлено в неструктурированном и трудночитаемом формате. Это приводит к дополнительным временным затратам на поиск и понимание информации, что создаёт путаницу и повышает риск ошибок при определении времени и места проведения занятий.</p>

<h2>Пользовательские сценарии</h2>
<ol>
    <li><b>Когда</b> я нахожусь в университете между парами и пытаюсь понять, куда идти дальше, <b>я хочу</b> быстро и без лишних кликов получить своё расписание на сегодняшний день в понятном виде без необходимости искать информацию на сайте, <b>чтобы</b> экономить время и видеть актуальные данные о времени и месте занятий.</li>
    <li><b>Когда</b> начинается новая учебная неделя, <b>я хочу</b> одним запросом получить полное, чётко структурированное расписание своей группы на всю неделю, <b>чтобы</b> быстро спланировать своё время, а не разбираться в трудночитаемой таблице на сайте, рискуя ошибиться.</li>
    <li><b>Когда</b> я регулярно смотрю расписание одной и той же группы или нескольких групп, <b>я хочу</b> иметь возможность сохранять их как избранные, <b>чтобы</b> каждый раз не вводить данные заново и получать расписание быстрее и удобнее.</li>
</ol>

<h2>Архитектура проекта</h2>
<h3>Нагрузка на сервис</h3>
<p>Число пользователей сервиса: 2500.<br>
Период хранения информации: 5 лет, т.к. расписание может использоваться для анализа учебного процесса, академического аудита, восстановления исторических данных и статистики.</p>

<h4>1) Соотношение R/W нагрузки</h4>
<ul>
    <li><b>Чтение:</b> 97%, т.к. пользователи регулярно запрашивают расписание на текущий день, неделю.</li>
    <li><b>Запись:</b> 3%, т.к. обновление расписания происходит раз в семестр, а регистрация новых пользователей — единичные события.</li>
</ul>

<h4>2) Объемы трафиĸа</h4>
<p>Объем одного сообщения: ~3 КБ;<br>
Среднее количество запросов на пользователя в сутки: 3;<br>
Объём одного запроса: ~0,25 КБ.</p>
<p><b>Входящий трафик (пользователь → бот):</b> 2500 * 0,25 КБ * 3 ≈ 1,8 МБ/сутки;<br>
<b>Исходящий трафик (бот → пользователь):</b> 2500 * 3 КБ * 3 ≈ 22 МБ/сутки.</p>

<h4>3) Объемы дисĸовой системы</h4>
<p>В университете 179 групп.<br>
В один семестр выходит примерно 100 000 занятий.</p>

<p>Оценки памяти для хранения таблиц в течение 5 лет с учётом индексов:</p>
<ul>
    <li>Занятия: ~340 МБ;</li>
    <li>Пользователи: ~232 КБ;</li>
    <li>Подгруппы: ~4,5 КБ;</li>
    <li>Группы: ~3,4 КБ;</li>
    <li>Специальности: ~4,4 КБ.</li>
</ul>
<p>Видно, что основной объём будет занимать таблица занятий с историей за 5 лет.</p>
<p>Таким образом, c учётом роста остальных таблиц общий объём базы данных через 5 лет оценивается около 360 МБ. Для обеспечения надёжной работы, в том числе при непредвиденном росте данных, целесообразно выделить 1-2 ГБ дискового пространства.</p>

<h3>C4-диаграммы</h3>
<h4>1) Диаграмма на уровне контекста</h4>
<img src="/images/С4-Context.png" alt="C4 Context">
<h4>2) Диаграмма на уровне контейнеров</h4>
<img src="/images/С4-Containers.png" alt="C4 Containers">

<h3>Контракты API</h3>
<p>Бот взаимодействует с API СЗГМУ.</p>
<p>Время ответа Telegram-бота: не более 5 секунд.</p>

<h3>Схема базы данных</h3>
<img src="/images/ERD.png" alt="ER-диаграмма">
<p>База данных должна выдержать нефункциональные требования, потому что основная нагрузка на сервис приходится на чтение, и используются индексы.</p>

<h3>Схема масштабирования сервиса при росте нагрузĸи</h3>
<p>Учитывая общее количество студентов, преподавателей и администрации университета, потенциальная аудитория сервиса может составить до 8 000 уникальных пользователей в день, если им начнёт пользоваться абсолютно весь институт.</p>
<h4>1) Вертикальное масштабирование</h4>
<p>Первоочередная и наименее сложная мера для повышения производительности отдельных компонентов. Недостаток состоит в дороговизне оборудования и невозможности улучшать бесконечно.</p>
<ul>
    <b><li>Для сервера приложения:</li></b>
        <p>Увеличение вычислительных ресурсов (CPU) и оперативной памяти (RAM) для обработки возросшего количества параллельных запросов от Telegram и эффективной работы с кешем.</p>
    <b><li>Для базы данных:</li></b>
        <p>Увеличение объема RAM для размещения в памяти ключевых индексов и горячих данных, что сократит время доступа. Переход на высокопроизводительные диски (NVMe SSD) для увеличения скорости операций ввода-вывода (I/O).</p>
</ul>
<h4>2)	Горизонтальное масштабирование:</h4>
<p>Мера для распределения нагрузки и обеспечения отказоустойчивости при исчерпании возможностей вертикального масштабирования.</p>
<ul>
    <b><li>Слой приложения:</li></b>
        <p>Запустить несколько идентичных инстансов бота с балансировщиком нагрузки. Это позволит равномерно распределять входящие запросы и устранит единую точку отказа.</p>
    <b><li>Слой кеширования:</li></b>
        <p>Для Redis перейти на управляемый кластер (Redis Cluster) для распределения данных.</p>
    <b><li>Слой данных (PostgreSQL):</li></b>
        <p>Внедрение репликации типа «ведущий-ведомый» (Master-Slave). Все операции записи будут направляться на основной узел (Master), а запросы на чтение — распределяться между одним или несколькими репликами (Slave), что увеличит пропускную способность для самой частой операции.</p>
</ul>
<h4>3)	Оптимизация структуры данных (Партиционирование):</h4>
<p>При росте таблицы lesson до миллионов записей можно применить партиционирование по диапазонам дат (например, по годам или семестрам). Это существенно ускорит выполнение запросов к актуальным данным (сканируется только нужная партиция) и упростит операции с архивом (например, перенос старых партиций на более медленные носители).</p>
